<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulário de Requisição de Suprimentos</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: 'Inter', sans-serif; }
    </style>
</head>
<body class="bg-gray-100">

    <!-- Modal de Sucesso -->
    <div id="successModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full flex items-center justify-center" style="display: none; z-index: 50;">
        <div class="relative mx-auto p-5 border w-11/12 md:w-1/2 max-w-lg shadow-lg rounded-lg bg-white">
            <div class="text-center">
                <h3 class="text-lg leading-6 font-medium text-gray-900">Pedido Gerado com Sucesso!</h3>
                <div class="mt-2 px-7 py-3">
                    <p class="text-sm text-gray-500 mb-4">O seu pedido foi formatado e está pronto para ser enviado. Escolha uma opção abaixo:</p>
                    <textarea id="pedidoGerado" class="w-full h-40 text-xs p-2 border rounded bg-gray-50" readonly></textarea>
                </div>
                <div class="items-center px-4 py-3 space-y-2 md:space-y-0 md:flex md:space-x-4">
                    <button id="copyButton" class="w-full md:w-auto px-4 py-2 bg-blue-500 text-white text-base font-medium rounded-md shadow-sm hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-300">Copiar Pedido</button>
                    <button id="emailButton" class="w-full md:w-auto px-4 py-2 bg-green-500 text-white text-base font-medium rounded-md shadow-sm hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-green-300">Enviar por E-mail</button>
                    <button id="closeModal" class="w-full md:w-auto px-4 py-2 bg-gray-300 text-gray-800 text-base font-medium rounded-md shadow-sm hover:bg-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-300">Fechar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Conteúdo Principal -->
    <div class="container mx-auto p-4 md:p-8 max-w-4xl">
        <div class="bg-white p-6 md:p-8 rounded-lg shadow-lg">
            
            <div class="text-center mb-6">
                <h1 class="text-2xl md:text-3xl font-bold text-gray-800">Formulário de Requisição de Suprimentos</h1>
                <p class="text-gray-600 mt-2">Preencha os seus dados e as quantidades desejadas.</p>
            </div>

            <form id="requisicaoForm" class="space-y-6">
                
                <!-- Dados do Solicitante -->
                <fieldset class="border p-4 rounded-lg">
                    <legend class="text-lg font-semibold text-gray-700 px-2">1. Dados do Solicitante</legend>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-2">
                        <div>
                            <label for="nome" class="block text-sm font-medium text-gray-700">Nome Completo</label>
                            <input type="text" id="nome" name="nome" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" required>
                        </div>
                        <div>
                            <label for="setor" class="block text-sm font-medium text-gray-700">Setor/Área</label>
                            <select id="setor" name="setor" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" required>
                                <option value="" disabled selected>Selecione seu setor</option>
                                <option>Arrecadação de IPTU</option>
                                <option>Arrecadação de ITBI</option>
                                <option>Rendas Imobiliárias</option>
                                <option>Cadastro Imobiliário</option>
                                <option>Atendimento</option>
                                <option>Assessoria de Análise Tributária</option>
                                <option>Arrecadação de TFE</option>
                                <option>Arrecadação de ISS</option>
                                <option>Rendas Mobiliária</option>
                                <option>Cadastro Mobiliário</option>
                            </select>
                        </div>
                    </div>
                </fieldset>

                <!-- Itens do Almoxarifado -->
                <fieldset class="border p-4 rounded-lg">
                    <legend class="text-lg font-semibold text-gray-700 px-2">2. Itens do Almoxarifado</legend>
                    <p class="text-sm text-gray-500 mb-4">Preencha a quantidade desejada (ex: "5 pacotes", "10 unidades", "1 kg"). Use a busca para filtrar.</p>
                    
                    <input type="text" id="filtroItens" placeholder="Buscar item..." class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm mb-4 focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                    
                    <div id="listaItens" class="space-y-3 max-h-96 overflow-y-auto pr-2">
                        <!-- Os itens estão agora no JavaScript -->
                    </div>
                </fieldset>

                <!-- Botão de Envio -->
                <div class="text-center">
                    <button type="submit" class="w-full md:w-1/2 px-6 py-3 bg-blue-600 text-white font-bold text-lg rounded-lg shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">Gerar Pedido</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // --- CONFIGURAÇÃO ---
        // O e-mail principal para o botão "Enviar por E-mail".
        // (Confirme se este é o e-mail correto)
        const emailGestor = 'diogenes.santos@betim.mg.gov.br';

        // A lista de itens do almoxarifado agora vive aqui.
        // Para adicionar/remover itens, edite esta lista.
        const itensDoAlmoxarifado = [
            "ALMOFADA PARA CARIMBO Nº 3",
            "APONTADOR EM MATERIAL PLÁSTICO",
            "BORRACHA BRANCA MACIA Nº40",
            "CANETA DESTACA TEXTO, VERDE",
            "CANETA ESFEROGRÁFICA, AZUL",
            "CLIPS NIQUELADO Nº2/0",
            "ENVELOPE SACO OFICIO S/ TIMBRE",
            "EXTRATOR DE GRAMPO",
            "FITA CREPE ESTREITA 19 MM X 50M",
            "FITA DUREX",
            "FITA MÁGICA TRANSPARENTE 12MM",
            "GOMAS ELÁSTICAS Nº18",
            "PERFURADOR PARA PAPEL",
            "LIVRO DE PROTOCOLO CAPA DURA",
            "PASTA CATÁLAGO COM 50",
            "PASTA PLASTIFICADA COM BA",
            "PRANCHETA EM EUCATEX, MANUAL",
            "RÉGUA ESCOLAR 3 CM",
            "TESOURA EM AÇO INOXIDÁVEL",
            "TINTA PARA ALMOFADA",
            "PINCEL P/ QUADRO BRANCO AZUL E PRETO",
            "ESPONJA DE AÇO BIODEGRADÁVEL",
            "ESPONJA DE NYLON",
            "FLANELA PARA LIMPEZA",
            "GRAMPEADOR INDUSTRIAL",
            "FITA ADESIVA EM PVC",
            "AÇUCAR CRISTAL",
            "MOUSE OPTICO USB",
            "DETERGENTE",
            "PAPEL A4",
            "GRAMPEADOR METÁLICO",
            "GRAMPO TRILHO EM PLÁSTICO",
            "ALCOOL LÍQUIDO 70º INPM",
            "LIXEIRA PLASTICA TELADA",
            "CANETA FIXA EM ALUMINIO"
        ];
        // --- FIM DA CONFIGURAÇÃO ---


        // Função para construir a lista de itens no HTML
        function carregarItens() {
            const listaItensDiv = document.getElementById('listaItens');
            listaItensDiv.innerHTML = ''; // Limpa a lista
            
            itensDoAlmoxarifado.forEach((itemNome, index) => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'grid grid-cols-3 gap-2 item-container';
                
                const label = document.createElement('label');
                label.htmlFor = `item-${index}`;
                label.className = 'col-span-2 text-sm font-medium text-gray-700 self-center item-nome';
                label.textContent = itemNome.trim();
                
                const input = document.createElement('input');
                input.type = 'text'; // Permite texto (ex: "5 pacotes")
                input.id = `item-${index}`;
                input.name = itemNome.trim();
                input.className = 'col-span-1 block w-full px-2 py-1 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500';
                
                itemDiv.appendChild(label);
                itemDiv.appendChild(input);
                listaItensDiv.appendChild(itemDiv);
            });
        }

        // Filtro de Busca
        document.getElementById('filtroItens').addEventListener('input', (e) => {
            const filtro = e.target.value.toLowerCase();
            document.querySelectorAll('.item-container').forEach(itemDiv => {
                const nomeItem = itemDiv.querySelector('.item-nome').textContent.toLowerCase();
                if (nomeItem.includes(filto)) {
                    itemDiv.style.display = 'grid';
                } else {
                    itemDiv.style.display = 'none';
                }
            });
        });

        // Lógica de Geração do Pedido
        const form = document.getElementById('requisicaoForm');
        const modal = document.getElementById('successModal');
        const pedidoGeradoText = document.getElementById('pedidoGerado');

        form.addEventListener('submit', (e) => {
            e.preventDefault();
            
            const formData = new FormData(form);
            let pedidoTexto = `--- PEDIDO DE SUPRIMENTOS ---\n\n`;
            pedidoTexto += `SOLICITANTE: ${formData.get('nome')}\n`;
            pedidoTexto += `SETOR: ${formData.get('setor')}\n`;
            pedidoTexto += `DATA DO PEDIDO: ${new Date().toLocaleDateString('pt-BR')}\n`;
            pedidoTexto += `\n--- ITENS SOLICITADOS ---\n`;
            
            let temItens = false;
            document.getElementById('listaItens').querySelectorAll('input[type="text"]').forEach(input => {
                if (input.value.trim() !== '') {
                    pedidoTexto += `- ${input.name}: ${input.value}\n`;
                    temItens = true;
                }
            });

            if (!temItens) {
                alert('Erro: Nenhum item foi solicitado. Por favor, preencha pelo menos uma quantidade.');
                return;
            }

            pedidoGeradoText.value = pedidoTexto;
            modal.style.display = 'flex';
        });

        // Funções do Modal
        document.getElementById('closeModal').addEventListener('click', () => modal.style.display = 'none');
        
        document.getElementById('copyButton').addEventListener('click', () => {
            pedidoGeradoText.select();
            document.execCommand('copy');
            alert('Pedido copiado para a área de transferência!');
        });

        document.getElementById('emailButton').addEventListener('click', () => {
            const assunto = `Novo Pedido de Suprimentos - ${document.getElementById('nome').value}`;
            const corpo = pedidoGeradoText.value;
            window.location.href = `mailto:${emailGestor}?subject=${encodeURIComponent(assunto)}&body=${encodeURIComponent(corpo)}`;
        });

        // Carrega os itens ao iniciar a página
        document.addEventListener('DOMContentLoaded', carregarItens);
    </script>
</body>
</html>


